<template>
    <template if:true={showModalMail}>
        <section
          role="dialog"
          tabindex="-1"
          aria-labelledby="modal-heading-01"
          aria-modal="true"
          aria-describedby="modal-content-id-1"
          class="slds-modal slds-fade-in-open">
          <div class="slds-modal__container" style="width: 1000px;">

            <!-- Header Start -->
            <header class="slds-modal__header">
              <lightning-button-icon class="slds-modal__close" title="Close" icon-name="utility:close" icon-class="slds-button_icon-inverse" onclick={handleSendMailClose}></lightning-button-icon>

              <h2 class="slds-text-heading_medium slds-hyphenate header-string">
                Send Mail
              </h2>
            </header>
            <!-- Header End -->

            <!-- BODY STARTS -->
            <div class="slds-modal__content slds-p-around_medium" id="modal-content-id-1">
                <article class="slds-card">

                    <!-- ALERT 1 STARTS -->
                    <div if:true={noEmailError} class="slds-notify slds-notify_alert slds-alert_error" role="alert">
                        <span class="slds-assistive-text">error</span>
                        <span class="slds-icon_container slds-icon-utility-error slds-m-right_x-small" title="Description of icon when needed">
                            <svg class="slds-icon slds-icon_x-small" aria-hidden="true">
                                <use xlink:href="/assets/icons/utility-sprite/svg/symbols.svg#error"></use>
                            </svg>
                        </span>
                        <h2>
                            Please add a recepient
                        </h2>
                        <div class="slds-notify__close">
                            <button class="slds-button slds-button_icon slds-button_icon-small slds-button_icon-inverse" title="Close">
                                <svg class="slds-button__icon" aria-hidden="true">
                                    <use xlink:href="/assets/icons/utility-sprite/svg/symbols.svg#close"></use>
                                </svg>
                                <span class="slds-assistive-text">Close</span>
                            </button>
                        </div>
                    </div>
                    <!-- ALERT 1 ENDS -->

                    <!-- ALERT 2 STARTS -->
                    <div if:true={invalidEmails} class="slds-notify slds-notify_alert slds-alert_error" role="alert">
                        <span class="slds-assistive-text">error</span>
                        <span
                            class="slds-icon_container slds-icon-utility-error slds-m-right_x-small"
                            title="Description of icon when needed"
                        >
                            <svg class="slds-icon slds-icon_x-small" aria-hidden="true">
                                <use xlink:href="/assets/icons/utility-sprite/svg/symbols.svg#error"></use>
                            </svg>
                        </span>
                        <h2>
                            Some of the emails added are invalid
                        </h2>
                        <div class="slds-notify__close">
                            <button class="slds-button slds-button_icon slds-button_icon-small slds-button_icon-inverse" title="Close">
                                <svg class="slds-button__icon" aria-hidden="true">
                                    <use xlink:href="/assets/icons/utility-sprite/svg/symbols.svg#close"></use>
                                </svg>
                                <span class="slds-assistive-text">Close</span>
                            </button>
                        </div>
                    </div>
                    <!-- ALERT 2 ENDS -->

                    <!-- BODY STARTS -->
                    <div class="slds-card__body slds-card__body_inner">
                        <div class="slds-form form slds-var-p-top_small">

                            <!-- FROM STARTS -->
                            <!-- <div class="slds-form-element slds-form-element_horizontal slds-form-element_1-col">
                                <label class="slds-form-element__label" for="from">From</label>
                                <div class="slds-form-element__control">
                                    <lightning-input placeholder={fromaddress} disabled></lightning-input>
                                </div>
                            </div> -->
                            <!-- FROM ends -->

                            <!-- TO STARTS -->
                            <div class="slds-form-element slds-form-element_horizontal slds-form-element_1-col">
                                <label class="slds-form-element__label" for="to">To</label>
                                <div class="slds-form-element__control">
                                    <lightning-input placeholder={toaddress} disabled></lightning-input>
                                    <!-- <c-email-input onselection={handleToAddressChange}></c-email-input> -->
                                </div>
                            </div>
                            <!-- TO STARTS -->

                            <!-- CC STARTS -->
                            <div class="slds-form-element slds-form-element_horizontal slds-form-element_1-col">
                                <label class="slds-form-element__label" for="cc">Cc</label>
                                <div class="slds-form-element__control">
                                    <c-email-input onselection={handleCcAddressChange}></c-email-input>
                                </div>
                            </div>
                            <!-- CC STARTS -->

                            <!-- SUBJECT STARTS -->
                            <div class="slds-form-element">
                                <label class="slds-form-element__label" for="subject"> </label>
                                <div class="slds-form-element__control">
                                    <input
                                        type="text"
                                        name="subject"
                                        id="subject"
                                        value={subject}
                                        placeholder="Subject..."
                                        class="slds-input"
                                        onchange={handleSubjectChange}/>
                                </div>
                            </div>
                            <!-- SUBJECT STARTS -->

                            <!-- CONTENT STARTS -->
                            <div class="slds-form-element">
                                <div class="slds-form-element__control slds-var-p-top_small">
                                    <lightning-input-rich-text value={body} onchange={handleBodyChange}></lightning-input-rich-text>
                                </div>
                            </div>
                            <!-- CONTENT ENDS -->

                        </div>
                    </div>
                    <!-- BODY ENDS -->

                    <div class="slds-var-p-around_medium">
                        <template for:each={files} for:item="file" for:index="index">
                            <lightning-pill
                                key={file.contentVersionId}
                                label={file.name}
                                onremove={handleRemove}
                                data-id={file.contentVersionId}
                                data-index={index}>

                                <lightning-icon icon-name="doctype:attachment" size="xx-small" alternative-text="attach"> </lightning-icon>
                            </lightning-pill>
                        </template>
                    </div>

                    <div class="slds-grid slds-grid_align-end slds-var-p-around_x-small">

                    </div>

                </article>

            </div>
            <!-- BODY ENDS -->

            <!-- FOOTER STARTS -->
            <footer class="slds-modal__footer">
                    <!-- ATTACHEMENT BUTTON STARTS -->
                    <div class="slds-col slds-var-p-right_x-small slds-var-p-bottom_x-small slds-is-relative" style="display: inline-block;">
                        <!-- UPLOAD FILE POP OVER STARTS -->
                        <section if:true={wantToUploadFile}
                            aria-describedby="dialog-body-id-108"
                            aria-labelledby="dialog-heading-id-3"
                            class="slds-popover slds-popover_walkthrough slds-nubbin_bottom slds-is-absolute popover"
                            role="dialog">
                            <button class="slds-button slds-button_icon slds-button_icon-small slds-float_right slds-popover__close slds-button_icon-inverse" title="Close dialog">
                                <lightning-button-icon
                                    variant="bare-inverse"
                                    size="small"
                                    onclick={toggleFileUpload}
                                    icon-name="utility:close"
                                    alternative-text="close"
                                ></lightning-button-icon>
                                <span class="slds-assistive-text">Close</span>
                            </button>
                            <header class="slds-popover__header slds-p-vertical_medium">
                                <h2 id="dialog-heading-id-3" class="slds-text-heading_medium">Upload Files</h2>
                            </header>
                            <div class="slds-popover__body" id="dialog-body-id-108">
                                <lightning-file-upload
                                    label="Attach files"
                                    name="fileUploader"
                                    accept={acceptedFormats}
                                    record-id={myRecordId}
                                    onuploadfinished={handleUploadFinished}
                                    multiple>
                                </lightning-file-upload>
                            </div>
                        </section>
                        <!-- UPLOAD FILE POP OVER ENDS -->

                        <lightning-button-icon
                            icon-name="utility:attach"
                            onclick={toggleFileUpload}
                            alternative-text="Attach File"
                            title="Attach_File">
                        </lightning-button-icon>
                    </div>
                    <!-- ATTACHEMENT BUTTON ENDS -->

                    <!-- RESET BUTTON STARTS -->
                    <div class="slds-col slds-var-p-right_x-small slds-var-p-bottom_x-small" style="display: inline-block;">
                        <lightning-button label="Reset" title="reset" onclick={handleReset}></lightning-button>
                    </div>
                    <!-- RESET BUTTON ENDS -->

                    <!-- SEND BUTTON STARTS -->
                    <div class="slds-col slds-var-p-right_x-small slds-var-p-bottom_x-small" style="display: inline-block;">
                        <lightning-button
                            variant="brand"
                            label="Send"
                            title="send"
                            onclick={handleSendEmail}>
                        </lightning-button>
                    </div>
                    <!-- SEND BUTTON ENDS -->
            </footer>
            <!-- FOOTER ENDS -->

          </div>
        </section>
        <div class="slds-backdrop slds-backdrop_open"></div>
      </template>
</template>